<br>

# â­ SciPyë¥¼ ì´ìš©í•œ í™•ë¥  ë¶„í¬ ë¶„ì„

<br>

## í™•ë¥ ë¶„í¬ ê°ì²´ ìƒì„±  


ê°ì²´ìƒì„± í•¨ìˆ˜  

|ì¢…ë¥˜|	ì´ë¦„|	í™•ë¥  ë¶„í¬|
|----|------|------|
|ì´ì‚°|	bernoulli|	ë² ë¥´ëˆ„ì´ ë¶„í¬|
|ì´ì‚°|	binom|	ì´í•­ ë¶„í¬|
|ì—°ì†|	uniform|	ê· ì¼ ë¶„í¬|
|ì—°ì†|	norm|	ê°€ìš°ì‹œì•ˆ ì •ê·œ ë¶„í¬|
|ì—°ì†|	beta|	ë² íƒ€ ë¶„í¬|
|ì—°ì†|	gamma|	ê°ë§ˆ ë¶„í¬|
|ì—°ì†|	t|	ìŠ¤íŠœë˜íŠ¸ t ë¶„í¬|
|ì—°ì†|	chi2|	ì¹´ì´ ì œê³± ë¶„í¬|
|ì—°ì†|	f|	F ë¶„í¬|
|ì—°ì†|	dirichlet|	ë””ë¦¬í´ë¦¬ ë¶„í¬|
|ì—°ì†|	multivariate_normal|	ë‹¤ë³€ìˆ˜ ê°€ìš°ì‹œì•ˆ ì •ê·œ ë¶„í¬|

<br>

## ì •ê·œë¶„í¬ ê·¸ë¦¬ê¸° : `stats.norm()`

```py
import numpy as np
from scipy import stats

np.random.seed(1)
print(stats.norm(loc=1, scale=2).rvs(10))  #ì •ê·œë¶„í¬ ê¸°ëŒ“ê°’: 1, í‘œì¤€ í¸ì°¨: 2, rvs(): ëœë¤ìƒ˜í”Œìƒì„±
```

ë¶„í¬ì˜ ëª¨ìˆ˜(parameter)ë¥¼ ì¸ìˆ˜ë¡œ ì§€ì •í•´ ì£¼ì–´ì•¼ í•œë‹¤.  
ë¶„ì‚°, í‘œì¤€í¸ì°¨ì˜ ì¤‘ìš”ì„± : ë¶„í¬ íŒŒì•…ì´ ê°€ëŠ¥í•˜ë‹¤. 


|ëª¨ìˆ˜(ì¸ìˆ˜)| ì˜ë¯¸|
|----|----|
|`loc`|	ì¼ë°˜ì ìœ¼ë¡œ ë¶„í¬ì˜ ê¸°ëŒ“ê°’|
|`scale`|	ì¼ë°˜ì ìœ¼ë¡œ ë¶„í¬ì˜ í‘œì¤€í¸ì°¨|
|`size`|	ìƒ˜í”Œ ìƒì„±ì‹œ ìƒì„±ë  ìƒ˜í”Œì˜ í¬ê¸°|
|`random_state`|	ìƒ˜í”Œ ìƒì„±ì‹œ ì‚¬ìš©ë˜ëŠ” ì‹œë“œ(seed)ê°’|

<br>

|ë©”ì„œë“œ|ê¸°ëŠ¥|
|----|----|
|`pdf`|í™•ë¥  ë°€ë„ í•¨ìˆ˜ (probability density function)  |
|`pmf`|í™•ë¥  ì§ˆëŸ‰ í•¨ìˆ˜ (probability mass function)  |
|`cdf`|ëˆ„ì  ë¶„í¬ í•¨ìˆ˜ (cumulative distribution function)   |
|`rvs`|ëœë¤ ìƒ˜í”Œ ìƒì„± (random variable sampling)  |
|`stats`|ê¸°ìˆ  í†µê³„ í•¨ìˆ˜ (descriptive statistics)  |
|`fit`|ëª¨ìˆ˜ ì¶”ì • (parameter estimation)|

<br>

## ê·¸ë˜í”„ë¡œ í™•ì¸

```py
import matplotlib.pyplot as plt

centers = [1, 1.5, 2]
col = 'rgb'

std = 0.1
data_1 = []
for i in range(3):
  data_1.append(stats.norm(centers[i], scale=std).rvs(100))
  #print(data_1)

  plt.plot(np.arange(len(data_1[i])) + i * len(data_1[0]), data_1[i], '*', c=col[i])

plt.show()
```

<br>

# **Chi Squared Test**

```py
import scipy.stats as stats
import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
```

<br>

# ğŸ“ **ì¹´ì´ì œê³±ê²€ì •**  

ì¹´ì´ì œê³± ê²€ì •(chi-squared test) ë˜ëŠ” Ï‡Â² ê²€ì •ì€ ì¹´ì´ì œê³± ë¶„í¬ì— ê¸°ì´ˆí•œ í†µê³„ì  ë°©ë²•ìœ¼ë¡œ,  ê´€ì°°ëœ ë¹ˆë„(ê´€ì¸¡ë¹ˆë„)ê°€ ê¸°ëŒ€ë˜ëŠ” ë¹ˆë„(ì˜ˆì¸¡ë¹ˆë„)ì™€ ì˜ë¯¸ìˆê²Œ ë‹¤ë¥¸ ì§€ ì¦‰, ì°¨ì´ê°€ í†µê³„ì ìœ¼ë¡œ ìœ ì˜í•œì§€ ì—¬ë¶€ë¥¼ ê²€ì •í•˜ê¸° ìœ„í•´ ì‚¬ìš©ë˜ëŠ” ë°©ë²•ì´ë‹¤. ìë£Œê°€ ë¹ˆë„ë¡œ ì£¼ì–´ì¡Œì„ ë•Œ, íŠ¹íˆ ëª…ëª©ì²™ë„(ë²”ì£¼í˜•) ìë£Œì˜ ë¶„ì„ì— ì´ìš©ë˜ë©° í™•ë¥ ëª¨í˜•ì´ ì „ë°˜ì ìœ¼ë¡œ ìë£Œë¥¼ ì–¼ë§ˆë‚˜ ì˜ ì„¤ëª…í•˜ëŠ”ì§€ ê²€ì •í•œë‹¤.  

ì§‘ë‹¨ ê°„ì˜ ë™ì§ˆì„± ì—¬ë¶€, ë‘ ë³€ì¸ ê°„ì˜ ìƒê´€ì„±ì„ í†µê³„ì ìœ¼ë¡œ ê²€ì¦í•˜ê³ ì í•  ë•Œ ì‚¬ìš©í•œë‹¤.  
ìˆ˜ì§‘ëœ ìë£Œê°€ ëª¨ì§‘ë‹¨ì— ëŒ€í•œ ë¶„í¬í˜•íƒœë¥¼ ê°€ì •í•  ìˆ˜ ì—†ëŠ” ê²½ìš°ì— ì‚¬ìš©í•˜ëŠ” ë¹„ëª¨ìˆ˜ì  í†µê³„ë°©ë²•ì˜ ì¼ì¢…ì´ë‹¤.  
ë‹¨, ë‘ ë³€ì¸(ë²”ì£¼) ê°„ì˜ ì¸ê³¼ê´€ê³„ëŠ” íŒŒì•…í•  ìˆ˜ ì—†ë‹¤.  

ë¹ˆë„í‘œë¥¼ ì‘ì„±í•˜ê³  ì´ë¥¼ ë°”íƒ•ìœ¼ë¡œ ë¶„ì„í•œë‹¤.  

<br>

1. ì í•©ì„± ê²€ì •   
ë²”ì£¼í˜• ìë£Œì— ëŒ€í•´ ê´€ì¸¡ëœ ê°’ì´ ê¸°ëŒ€í•œ ê°’ê³¼ ì–¼ë§ˆë‚˜ ì°¨ì´ê°€ ë‚˜ëŠ” ì§€, ê´€ì¸¡ì¹˜ê°€ íŠ¹ì • ë¶„í¬ë¥¼ ë”°ë¥´ëŠ” ì§€ë¥¼ ê²€ì •í•œë‹¤.  

2. ë™ì¼ì„± ê²€ì •  
ë‘ ì§‘ë‹¨ì˜ ë¶„í¬ê°€ ë™ì¼í•œì§€ë¥¼ ê²€ì •í•œë‹¤.  

3. ë…ë¦½ì„± ê²€ì •  
ëª¨ì§‘ë‹¨ì—ì„œ ì¶”ì¶œí•œ ìë£Œë“¤ì´ ë‘ ê°€ì§€ ë³€ìˆ˜ A, Bì— ì˜í•´ì„œ ë²”ì£¼í™”ë˜ì–´ ìˆì„ ë•Œ (ë¶„í• í‘œ ìƒì˜ ë³€ìˆ˜), ì´ ë‘ ë³€ìˆ˜ Aì™€ B ì‚¬ì´ì— ì—°ê´€ì„±ì´ ìˆëŠ” ì§€ë¥¼ ê²€ì •í•˜ëŠ” ê²ƒì´ë‹¤.  
ì¦‰, ë‘ ë³€ìˆ˜ ì‚¬ì˜ì˜ ë…ë¦½ì„±ì„ ê²€ì •í•œë‹¤.

<br>

## ğŸ”¹ ì¹´ì´ì œê³± í†µê³„ëŸ‰ : Ï‡Â²

ì¹´ì´ì œê³± í†µê³„ëŸ‰ì€ ë°ì´í„°ì˜ ë¶„í¬ì™€ ê°€ì •ëœ ë¶„í¬ ì‚¬ì´ì˜ ì°¨ì´ë¥¼ ë‚˜íƒ€ë‚´ëŠ” ì¸¡ì •ê°’ì´ë‹¤.  
ì¹´ì´ì œê³± í†µê³„ëŸ‰ì´ ì¹´ì´ì œê³± ë¶„í¬ë¥¼ ë”°ë¥¸ë‹¤ë©´ ì¹´ì´ì œê³± ë¶„í¬ë¥¼ ì‚¬ìš©í•´ ê°€ì„¤ê²€ì •ì„ ìˆ˜í–‰í•œë‹¤. 

> ì¹´ì´ì œê³± ê°’ Ï‡Â² = âˆ‘(ê´€ì¸¡ê°’ - ê¸°ëŒ€ê°’)Â² / ê¸°ëŒ€ê°’

<br>

## ğŸ”¹ P-Value

ì¹´ì´ì œê³± ê²€ì •ì„ í†µí•´ P-Valueë¥¼ ì–»ê²Œ ëœë‹¤. P-ValueëŠ” ê²€ì • ê²°ê³¼ê°€ ì–¼ë§ˆë‚˜ ìœ ì˜í•œ ì§€ë¥¼ ë‚˜íƒ€ë‚´ëŠ” ì§€í‘œë¡œ ì‚¬ìš©ëœë‹¤.  

P-ValueëŠ” ê²€ì • í†µê³„ëŸ‰ì— ê´€í•œ í™•ë¥ ë¡œ ê²€ì • í†µê³„ëŸ‰ë³´ë‹¤ í¬ê±°ë‚˜ ê°™ì€ ê°’ì„ ì–»ì„ ìˆ˜ ìˆì„ í™•ë¥ ì„ ì˜ë¯¸í•œë‹¤.  
ê²€ì • í†µê³„ëŸ‰ì€ ê±°ì˜ ëŒ€ë¶€ë¶„ì´ ê·€ë¬´ê°€ì„¤ì„ ê°€ì •í•˜ê³  ì–»ê²Œ ë˜ëŠ” ê°’ì´ë‹¤.  
ì¦‰, ê·€ë¬´ê°€ì„¤ì„ ê°€ì •í•œ ë¶„í¬ì™€ ë™ì¼í•  í™•ë¥ ì´ë‹¤.  

ê·¸ëŸ¬ë¯€ë¡œ P-Valueê°€ ìœ ì˜ìˆ˜ì¤€ë³´ë‹¤ ì‘ìœ¼ë©´ ê·€ë¬´ê°€ì„¤ì„ ê¸°ê°í•˜ê³  ëŒ€ë¦½ê°€ì„¤ì„ ì±„íƒí•˜ê²Œ ëœë‹¤.

<br>

ì¹´ì´ì œê³± ê²€ì •ì„ ìˆ˜í–‰í•˜ê³ , P-Valueë¥¼ ì–»ê¸° ìœ„í•´ì„œëŠ” ë‘ ê°€ì§€ì˜ ì •ë³´ê°€ í•„ìš”í•˜ë‹¤.  

> 1) ììœ ë„  
2) ìœ ì˜ìˆ˜ì¤€(Î±) : ì—°êµ¬ìì— ì˜í•´ ê²°ì •ë¨

<br>

## ğŸ”¹ ììœ ë„ (Degree of Freedom)

í†µê³„ì  ì¶”ì •ì„ í•  ë•Œ í‘œë³¸ìë£Œ ì¤‘ ëª¨ì§‘ë‹¨ì— ëŒ€í•œ ì •ë³´ë¥¼ ì£¼ëŠ” ë…ë¦½ì ì¸ ìë£Œì˜ ìˆ˜ë¥¼ ë§í•œë‹¤.  

ììœ ë„ëŠ” ëª¨ë¶„ì‚°ì„ ëª¨ë¥´ê¸° ë•Œë¬¸ì— í•„ìš”í•˜ë‹¤.  
í‘œë³¸ì˜ ë¶„ì‚°ì€ ëª¨ì§‘ë‹¨ì˜ ë¶„ì‚°ë³´ë‹¤ í•­ìƒ ì‘ì•„ì§€ëŠ” ê²½í–¥ì„ ë³´ì´ê¸° ë•Œë¬¸ì— (í¸í–¥ì´ ë°œìƒ) í‘œë³¸ì˜ ë¶„ì‚°ì„ ëª¨ì§‘ë‹¨ì˜ ë¶„ì‚°ì— ê·¼ì‚¬í•˜ê²Œ í•˜ê¸° ìœ„í•˜ì—¬ ì¼ì • ë¹„ìœ¨ì„ ê³±í•´ì¤€ë‹¤.  
ê·¸ ë¹„ìœ¨ì€ n / (n-1) ì´ë©°, í‘œë³¸ì˜ ë¶„ì‚°ì— ì´ ë¹„ìœ¨ì„ ê³±í•˜ë©´ ëª¨ì§‘ë‹¨ì˜ ë¶„ì‚°ì— ê·¼ì‚¬í•˜ê²Œ ëœë‹¤.  

ë˜í•œ ë¶„ì‚°ì˜ ì›ë˜ ê³„ì‚°ì‹ì— ìˆëŠ” ë¶„ëª¨ì˜ nì´ ì•½ë¶„ë˜ê¸° ë•Œë¬¸ì— (n-1)ë§Œ ë‚¨ê²Œëœë‹¤.  
ì¦‰, í‘œë³¸ì˜ ë¶„ì‚°ì„ êµ¬í•  ë•Œ, n ëŒ€ì‹  n-1ì„ ë‚˜ëˆ„ë©´ í‘œë³¸ì˜ ë¶„ì‚°ì„ ëª¨ì§‘ë‹¨ì˜ ë¶„ì‚°ì— ê·¼ì‚¬í•´ì§€ê²Œ í•  ìˆ˜ ìˆëŠ” ê²ƒì´ë‹¤.   

ë”°ë¼ì„œ ììœ ë„ëŠ” í‘œë³¸ì˜ í‰ê· ì„ êµ¬í•  ë•ŒëŠ” ì‚¬ìš©ë˜ì§€ ì•Šê³  í‘œë³¸ì˜ ë¶„ì‚°ì„ êµ¬í•  ë•Œë§Œ ì‚¬ìš©ëœë‹¤.  


> df = N - K  í˜¹ì€ N-1  
ììœ ë„ = ì‚¬ë¡€ìˆ˜ - í†µê³„ì ì œí•œì¡°ê±´ìˆ˜  (ë²”ì£¼ì˜ìˆ˜-1)

ì¹´ì´ì œê³±ì—ì„œì˜ ììœ ë„  
> rí–‰ cì—´ì˜ ë¶„í• í‘œì—ì„œ ì¹´ì´ì œê³± í†µê³„ëŸ‰ì˜ ììœ ë„ëŠ” (r-1)*(c-1) ì´ë‹¤.

<br>

## ì˜ˆì œ 1

> ê°€ì„¤ì„¤ì •  
ê·€ë¬´ê°€ì„¤ : ë²¼ë½ì¹˜ê¸°ë¡œ ê³µë¶€í•˜ëŠ” ê²ƒê³¼ í•©ê²© ì—¬ë¶€ëŠ” ê´€ê³„ê°€ ì—†ë‹¤.  
ëŒ€ë¦½ê°€ì„¤ : ë²¼ë½ì¹˜ê¸°ë¡œ ê³µë¶€í•˜ëŠ” ê²ƒê³¼ í•©ê²© ì—¬ë¶€ëŠ” ê´€ê³„ê°€ ìˆë‹¤.

<br>

### ë°ì´í„° ì¤€ë¹„

ë²¼ë½ì¹˜ê¸° ê³µë¶€ ì—¬ë¶€ì— ë”°ë¥¸ í•©ê²©, ë¶ˆí•©ê²© ë°ì´í„°

```py
import pandas as pd
data = pd.read_csv('/content/drive/MyDrive/testdata/pass_cross.csv', encoding = 'euc-kr')
print(data.head(3))
print(data.shape[0], data.shape[1])

print(data[(data['ê³µë¶€í•¨']==1) & (data['í•©ê²©']==1)].shape[0])
print(data[(data['ê³µë¶€í•¨']==1) & (data['ë¶ˆí•©ê²©']==1)].shape[0])
```

<br>

ë¹ˆë„í‘œ ì‘ì„±

```py
data2 = pd.crosstab(index = data['ê³µë¶€ì•ˆí•¨'], columns = data['ë¶ˆí•©ê²©'], margins = True)
data2.columns = ['í•©ê²©','ë¶ˆí•©ê²©','í–‰í•©']
data2.index = ['ê³µë¶€í•¨','ê³µë¶€ì•ˆí•¨','ì—´í•©']
print(data2)
```

<br>

### ğŸ‘‰ ìˆ˜ì‹ì„ ì´ìš©í•´ Ï‡Â² ê°’ êµ¬í•˜ê¸°


ê¸°ëŒ€ê°’ êµ¬í•˜ê¸° : (ê° í–‰ì˜ ì£¼ë³€ê°’) * (ê° ì—´ì˜ ì£¼ë³€ê°’) / ì´í•©

```py
chi2 = (18 - 15)**2 / 15 + (7 - 10)**2 / 10 + (12 -15)**2 / 15 + (13 - 10)**2 / 10
print(chi2)
```

ììœ ë„ëŠ” (2-1)*(2-1) ==> 1 

ì„ê³„ê°’ì€ ì¹´ì´ì œê³± ë¶„í¬í‘œ ì‚¬ìš© : 3.84  

ê²°ë¡  : chi2ê°’ 3.0ì€ ì„ê³„ê°’ 3.84ë³´ë‹¤ ì‘ìœ¼ë¯€ë¡œ ê·€ë¬´ì±„íƒì—­ì— chi2ê°’ì´ ì¡´ì¬í•˜ì—¬ ê·€ë¬´ê°€ì„¤ì„ ì±„íƒí•œë‹¤.   
ì¦‰, ë²¼ë½ì¹˜ê¸° ê³µë¶€ë¥¼ í•˜ëŠ” ê²ƒê³¼ í•©ê²©ì—¬ë¶€ëŠ” ê´€ê³„ê°€ ì—†ë‹¤ê³  í•  ìˆ˜ ìˆë‹¤.

<br>

### ğŸ‘‰ ëª¨ë“ˆì´ ì§€ì›í•˜ëŠ” í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•´ Ï‡Â²ê°’ê³¼ p-value êµ¬í•˜ê¸° : `chi2_contingency()`  

Ï‡Â²ê°’ê³¼ p-valueëŠ” ë°˜ë¹„ë¡€ ê´€ê³„ì´ë‹¤.

```py
import scipy.stats as stat

chi2, p, ddof, excepted = stats.chi2_contingency(data2)
print('chi2 :', chi2)
print('p :', p)                #p-value
print()
print('ddof :', ddof)
print('excepted :', excepted)  #ì˜ˆì¸¡ê°’
```

ìœ ì˜ìˆ˜ì¤€(Î±=0.05) < p-value(0.557825400) ì´ë¯€ë¡œ ê·€ë¬´ê°€ì„¤ì„ ì±„íƒí•œë‹¤.

<br>

# ğŸ“ **ì¼ì›ì¹´ì´ì œê³±ê²€ì • (One-way Ï‡Â² test)**

ì í•©ë„ (goodness of fit) ê²€ì •ì´ë¼ê³ ë„ í•œë‹¤.  í•œ ê°œì˜ ë²”ì£¼í˜• ìš”ì¸ (í•˜ë‚˜ì˜ ë³€ìˆ˜) ì„ ì‚¬ìš©.  
ê´€ì¸¡ê°’ë“¤ì´ ì–´ë– í•œ ì´ë¡ ì  ë¶„í¬ë¥¼ ë”°ë¥´ê³  ìˆëŠ”ì§€ í™•ì¸í•œë‹¤.  

ex) ê½ƒ ìƒ‰ê¹”ì˜ í‘œí˜„ ë¶„ë¦¬ë¹„ìœ¨ì´ 3:1ì´ ë§ëŠ”ê°€?

<br>

## ğŸ”¹ ì í•©ë„ ê²€ì •  : `chisquare()`

ì£¼ì‚¬ìœ„ë¥¼ 60 íšŒ ë˜ì ¸ì„œ ë‚˜ì˜¨ ê´€ì¸¡ë„ìˆ˜ / ê¸°ëŒ€ë„ìˆ˜ê°€ ì•„ë˜ì™€ ê°™ì´ ë‚˜ì˜¨ ê²½ìš°ì— ì´ ì£¼ì‚¬ìœ„ëŠ” ì í•©í•œ ì£¼ì‚¬ìœ„ê°€ ë§ëŠ”ê°€ë¥¼ ì¼ì›ì¹´ì´ì œê³± ê²€ì •
ìœ¼ë¡œ ë¶„ì„

> ì£¼ì‚¬ìœ„ëˆˆê¸ˆ   1  2  3  4  5  6  
ê´€ì¸¡ë„ìˆ˜       4  6 17  16 8  9  
ê¸°ëŒ€ë„ìˆ˜       10 10 10 10 10 10  

<br>

ê°€ì„¤ì„¤ì •

> ê·€ë¬´ê°€ì„¤ : ì£¼ì‚¬ìœ„ëŠ” ê²Œì„ì— ì í•©í•˜ë‹¤.  -> ê¸°ëŒ€ì¹˜ì™€ ê´€ì¸¡ì¹˜ëŠ” ì°¨ì´ê°€ ì—†ë‹¤. ë…ë¦½ì ì´ë‹¤. ìƒê´€ì´ ì—†ë‹¤.  
ëŒ€ë¦½ê°€ì„¤ : ì£¼ì‚¬ìœ„ëŠ” ê²Œì„ì— ì í•©í•˜ì§€ ì•Šë‹¤. -> ê¸°ëŒ€ì¹˜ì™€ ê´€ì¸¡ì¹˜ëŠ” ì°¨ì´ê°€ ìˆë‹¤. ë…ë¦½ì ì´ì§€ ì•Šë‹¤. ìƒê´€ì´ ìˆë‹¤.

```py
import pandas as pd
import scipy.stats as stats

data = [4, 6, 17, 16, 8, 9]
data2 = [10, 10, 10, 10, 10, 10]
print(stats.chisquare(data))
print()

result1 = stats.chisquare(data)
print('í†µê³„ëŸ‰(chi2) : %.5f, p-value: %.5f'%result1)
print()

result2 = stats.chisquare(data, data2)
print('í†µê³„ëŸ‰(chi2) : %.5f, p-value: %.5f'%result2)
```

í•´ì„1:  
p-value:0.01439 < 0.05 ì´ë¯€ë¡œ ìœ ì˜ë¯¸í•œ ìˆ˜ì¤€(Î±=0.05)ì—ì„œ ê·€ë¬´ê°€ì„¤ì„ ê¸°ê°í•˜ê³ , ëŒ€ë¦½ê°€ì„¤ì„ ì±„íƒí•œë‹¤.  
ì¦‰, í˜„ì¬ ì‹¤í—˜ì— ì‚¬ìš©ëœ ì£¼ì‚¬ìœ„ëŠ” ê²Œì„ì— ì í•©í•˜ì§€ ì•Šë‹¤.  

í•´ì„2:  
ì¹´ì´ì œê³±ë¶„í¬ë¥¼ ì‚¬ìš©í•œ ê²°ê³¼ ì„ê³„ê°’ : 11.07 < 14.2000 ì´ë¯€ë¡œ ê·€ë¬´ê°€ì„¤ì„ ê¸°ê°í•˜ê³  ëŒ€ë¦½ê°€ì„¤ì„ ì±„íƒí•œë‹¤.

<br>

## ğŸ”¹ ì„ í˜¸ë„ ê²€ì •  

5ê°œì˜ ìŠ¤í¬ì¸  ìŒë£Œì— ëŒ€í•œ ì„ í˜¸ë„ì— ì°¨ì´ê°€ ìˆëŠ”ì§€ ê²€ì •í•˜ê¸° : drinkdata.csv

```py
data3 = pd.read_csv('/content/drive/MyDrive/testdata/drinkdata.csv')
print(data3)
print()

print(stats.chisquare(data3['ê´€ì¸¡ë„ìˆ˜']))
```

í•´ì„:  
p-value=0.00039991 < 0.05 ì´ë¯€ë¡œ ê·€ë¬´ê°€ì„¤ì„ ê¸°ê°í•˜ê³  ëŒ€ë¦½ê°€ì„¤ì„ ì±„íƒí•œë‹¤.

<br>

# ğŸ“ **ì´ì›ì¹´ì´ì œê³±ê²€ì •  (Two-way Ï‡Â² test)**

ë‘ ê°œ ì´ìƒì˜ ì§‘ë‹¨ ë˜ëŠ” ë²”ì£¼ì˜ ë³€ì¸ì„ ëŒ€ìƒìœ¼ë¡œ ë…ë¦½ì„±, ë™ì§ˆì„± ê²€ì •
- ë™ì¼ ì§‘ë‹¨ì˜ ë‘ ë³€ì¸(ex í•™ë ¥ìˆ˜ì¤€ê³¼ ëŒ€í•™ì§„í•™ ì—¬ë¶€)ì„ ëŒ€ìƒìœ¼ë¡œ ê´€ë ¨ì„±ì´ ìˆëŠ”ì§€ ì—†ëŠ”ì§€ í™•ì¸  
- ë…ë¦½ì„± ê²€ì •ì€ ë‘ ë³€ìˆ˜ ì‚¬ì´ì˜ ì—°ê´€ì„±ìœ¼ë¡œ ê²€ì •í•œë‹¤.

<br>

## ğŸ”¹ ë…ë¦½ì„± ê²€ì •

ì‹¤ìŠµ : êµìœ¡ìˆ˜ì¤€ê³¼ í¡ì—° ê°„ì˜ ê´€ë ¨ì„± ë¶„ì„ : smoke.csv

<br>

ê°€ì„¤ì„¤ì •

> ê·€ë¬´ê°€ì„¤ : êµìœ¡ìˆ˜ì¤€ê³¼ í¡ì—°ì€ ê´€ë ¨ì´ ì—†ë‹¤. (ë…ë¦½ì´ë‹¤.)  
ëŒ€ë¦½ê°€ì„¤ : êµìœ¡ìˆ˜ì¤€ê³¼ í¡ì—°ì€ ê´€ë ¨ì´ ìˆë‹¤. (ë…ë¦½ì´ ì•„ë‹ˆë‹¤.)

```py
import pandas as pd
import scipy.stats as stats

data = pd.read_csv('/content/drive/MyDrive/testdata/smoke.csv')
print(data.head(3))
print(data.tail(3))
print()

print(data['education'].unique()) #ëŒ€í•™ì›ì¡¸ ëŒ€ì¡¸ ê³ ì¡¸
print(data['smoking'].unique())   #ê³¼í¡ì—° ë³´í†µ ë…¸ë‹´
```

<br>

### êµì°¨í‘œ ì‘ì„± : `crosstab()`

êµìœ¡ìˆ˜ì¤€ë³„ í¡ì—° ì¸ì›ìˆ˜ë¥¼ íŒŒì•…í•˜ê¸° ìœ„í•´ êµì°¨í‘œ ì‘ì„±í•œë‹¤. 

ì•¼íŠ¸ë³´ì • : ë¶„í• í‘œì˜ ììœ ë„ê°€ 1ì¸ ê²½ìš°ëŠ” Ï‡Â²ê°’ì´ ì•½ê°„ ë†’ê²Œ ê³„ì‚°ëœë‹¤.  
ê·¸ë˜ì„œ ì ˆëŒ€ê°’ |O-E|ì—ì„œ 0.5ë¥¼ ëº€ ë‹¤ìŒ ì œê³±í•˜ì—¬ ì ìš©í•œë‹¤.  
ì´ë¥¼ ì•¼íŠ¸ë³´ì •ì´ë¼ê³  í•˜ë©° chi2_contingencyì—ì„œëŠ” ë³´ì •ì´ ìë™ìœ¼ë¡œ ì´ë£¨ì–´ì§„ë‹¤

```py
ctab = pd.crosstab(index = data['education'], columns = data['smoking'])  #normalize=True : ë¹„ìœ¨ë¡œ ì¶œë ¥. í˜„ì¬ëŠ” ë²”ì£¼í˜•ë°ì´í„°ë¼ ì ìš©X
ctab.index = ['ëŒ€í•™ì›','ëŒ€í•™','ê³ ë“±êµìœ¡']
ctab.columns = ['ê³¼í¡ì—°','í¡ì—°','ë¹„í¡ì—°']

print(ctab)
```

<br>

### Scipyì˜ `chi2_contingency()`


```py
chi_result = [ctab.loc['ëŒ€í•™ì›'], ctab.loc['ëŒ€í•™'], ctab.loc['ê³ ë“±êµìœ¡']]
chi2, p, ddof, exp = stats.chi2_contingency(chi_result)
#chi2, p, ddof, exp = stats.chi2_contingency(ctab)   #í˜„ì¬ ë°ì´í„°ëŠ” ê°€ëŠ¥

print('chi2 :', chi2)
print('p :', p)
```

í•´ì„:  
p-value (0.00081825) < ìœ ì˜ìˆ˜ì¤€ (0.05) ì´ë¯€ë¡œ ê·€ë¬´ê°€ì„¤ì„ ê¸°ê°í•˜ê³  ëŒ€ë¦½ê°€ì„¤ì„ ì±„íƒí•œë‹¤.

<br>

### ì˜ˆì œ 1) ë…ë¦½ì„± ê²€ì • : ì¸ì¢… ê°„ ì¸ì›ìˆ˜ ğŸ‘§ğŸ¿ğŸ‘©ğŸ‘±ğŸ»â€â™‚ï¸

êµ­ê°€ ì „ì²´ì™€ ì§€ì—­ì— ëŒ€í•œ ì¸ì¢… ê°„ ì¸ì›ìˆ˜ë¡œ ë…ë¦½ì„± ê²€ì •ì„ ì‹¤ìŠµí•´ë³´ì.  

ë‘ ì§‘ë‹¨ (êµ­ê°€ ì „ì²´ - national, íŠ¹ì •ì§€ì—­ - la) ì˜ ì¸ì¢…ê°„ ì¸ì›ìˆ˜ì˜ ë¶„í¬ê°€ ê´€ë ¨ì´ ìˆëŠ”ê°€?

```py
import pandas as pd
import scipy.stats as stats

national = pd.DataFrame(['white']*100000 + ['hispanic']*60000 + ['black']*50000 + ['asian']*15000 + 
                        ['other']*35000)
la = pd.DataFrame(['white']*600 + ['hispanic']*300 + ['black']*250 + ['asian']*75 + 
                        ['other']*150)
print(national)
print()
print(la)

na_table = pd.crosstab(index=national[0], columns='count')
la_table = pd.crosstab(index=la[0], columns='count')
print(na_table)
na_table['count_la'] = la_table['count']
print(na_table)

chi2, p, ddof, _ = stats.chi2_contingency(na_table)
print("chi2 : ", chi2)# chi2 :  18.099524243141698
print("p : ", p)# p :  0.0011800326671747886
print("ddof : ", ddof)# ddof :  4
```

í•´ì„ : p-value 0.0011800326671747886 < 0.05 ìœ ì˜ìˆ˜ì¤€ ë³´ë‹¤ ë§¤ìš°ì‘ê¸° ë•Œë¬´ì— ê·€ë¬´ê°€ì„¤ì€ ê¸°ê°í•˜ê³  ëŒ€ë¦½ê°€ì„¤ì„ ì±„íƒí•œë‹¤.

<br>

## ğŸ”¹ ë™ì§ˆì„± ê²€ì •

ë‘ ì§‘ë‹¨ì˜ ë¶„í¬ê°€ ë™ì¼í•œê°€ ë‹¤ë¥¸ ê°€ë¥¼ ê²€ì¦í•˜ëŠ” ë°©ë²•ì´ë‹¤. ë‘ ì§‘ë‹¨ ì´ìƒì—ì„œ ê° ë²”ì£¼(ì§‘ë‹¨) ê°„ì˜ ë¹„ìœ¨ì´ ì„œë¡œ ë™ì¼í•œê°€ë¥¼ ê²€ì •í•˜ê²Œ ëœë‹¤.  
ë‘ ê°œ ì´ìƒì˜ ë²”ì£¼í˜• ìë£Œê°€ ë™ì¼í•œ ë¶„í¬ë¥¼ ê°–ëŠ” ëª¨ì§‘ë‹¨ì—ì„œ ì¶”ì¶œëœ ê²ƒì¸ì§€ ê²€ì •í•˜ëŠ” ë°©ë²•ì´ë‹¤.

```py
import pandas as pd
import scipy.stats as stats

#ë™ì§ˆì„± ê²€ì •ì‹¤ìŠµ 1) êµìœ¡ë°©ë²•ì— ë”°ë¥¸ êµìœ¡ìƒë“¤ì˜ ë§Œì¡±ë„ ë¶„ì„ - ë™ì§ˆì„± ê²€ì • survey_method.csv
data = pd.read_csv('/content/drive/MyDrive/testdata/survey_method.csv')
print(data.head(5))
print()

print(data['method'].unique())

ctab = pd.crosstab(index=data['method'], columns=data['survey'])
ctab.columns = ['ë§¤ìš°ë§Œì¡±','ë§Œì¡±','ë³´í†µ','ë¶ˆë§Œì¡±','ë§¤ìš°ë¶ˆë§Œì¡±']
ctab.index = ['ë°©ë²•1','ë°©ë²•2','ë°©ë²•3']

print(ctab)

chi2_result = [ctab.loc['ë°©ë²•1'], ctab.loc['ë°©ë²•2'], ctab.loc['ë°©ë²•3']]
chi2, p, ddof, _ = stats.chi2_contingency(chi2_result)
msg = 'ê²€ì •í†µê³„ëŸ‰ chi2: {}, p-value: {}, ddof: {}'
print(msg.format(chi2, p, ddof))
```

í•´ì„:  
pê°’ 0.5864 > 0.05 ì´ë¯€ë¡œ ê·€ë¬´ê°€ì„¤ì„ ì±„íƒí•œë‹¤.

êµìœ¡ë°©ë²•ì— ë”°ë¥¸ êµìœ¡ìƒë“¤ì˜ ë§Œì¡±ë„ì— ì°¨ì´ê°€ ì—†ë‹¤.

<br>

### ì˜ˆì œ 2) ë™ì§ˆì„± ê²€ì • : ì—°ë ¹ëŒ€ë³„ SNS ì´ìš©ë¥  ğŸ“³

ì—°ë ¹ëŒ€ë³„ SNS ì´ìš©ë¥ ì˜ ë™ì§ˆì„± ê²€ì •  
20ëŒ€ì—ì„œ 40ëŒ€ê¹Œì§€ ì—°ë ¹ëŒ€ë³„ë¡œ ì„œë¡œ ì¡°ê¸ˆì”© ê·¸ íŠ¹ì„±ì´ ë‹¤ë¥¸ SNS ì„œë¹„ìŠ¤ë“¤ì— ëŒ€í•´ ì´ìš© í˜„í™©ì„ ì¡°ì‚¬í•œ ìë£Œë¥¼ ë°”íƒ•ìœ¼ë¡œ  ì—°ë ¹ëŒ€ë³„ë¡œ í™ë³´ì „ëµì„ ì„¸ìš°ê³ ì í•œë‹¤.  ì—°ë ¹ëŒ€ë³„ë¡œ ì´ìš©í˜„í™©ì´ ì„œë¡œ ë™ì¼í•œì§€ ê²€ì •í•´ë³´ë„ë¡ í•˜ì.  

<br>

ê°€ì„¤ì„¤ì •  
> ê·€ë¬´ê°€ì„¤ : ì—°ë ¹ëŒ€ë³„ë¡œ SNS ì„œë¹„ìŠ¤ ì´ìš©í˜„í™©ì´ ë™ì¼í•˜ë‹¤.  
ëŒ€ë¦½ê°€ì„¤ : ì—°ë ¹ëŒ€ë³„ë¡œ SNS ì„œë¹„ìŠ¤ ì´ìš©í˜„í™©ì´ ë™ì¼í•˜ì§€ ì•Šë‹¤.

```py
import pandas as pd
import scipy.stats as stats

data = pd.read_csv('/content/drive/MyDrive/testdata/snsbyage.csv')
print(data.head(5))
print(len(data))
print()

print(data['age'].unique())
print(data['service'].unique())
```

ë¹ˆë„í‘œ

```py
ctab = pd.crosstab(index=data['age'], columns=data['service'])  #ë‚˜ì´ë³„ ì„œë¹„ìŠ¤ ì´ìš© ì¸ì›ìˆ˜
print(ctab)

chi2, p, df, exp = stats.chi2_contingency(ctab)
msg = 'chi2: {}, p-value: {}, ddof: {},'
print(msg.format(chi2, p, df))
```

p-valueê°€ 1.1679064204212775e-18ìœ¼ë¡œ ìœ ì˜ìˆ˜ì¤€ 0.05ë³´ë‹¤ ì‘ê¸° ë•Œë¬¸ì— ê·€ë¬´ê°€ì„¤ì„ ê¸°ê°í•˜ê³  ëŒ€ë¦½ê°€ì„¤ì„ ì±„íƒí•œë‹¤.  

ì—°ë ¹ëŒ€ë³„ë¡œ SNS ì„œë¹„ìŠ¤ ì´ìš©í˜„í™©ì´ ë™ì¼í•œì§€ 1439ëª…ì„ ëŒ€ìƒìœ¼ë¡œ ì„¤ë¬¸ì¡°ì‚¬í•œ ê²°ê³¼,  
ì—°ë ¹ëŒ€ì— ë”°ë¼ ì£¼ë¡œ ì‚¬ìš©í•˜ëŠ” SNS ì„œë¹„ìŠ¤ëŠ” ì„œë¡œ ë‹¤ë¥¸ ê²ƒìœ¼ë¡œ ë³¼ ìˆ˜ ìˆë‹¤.

<br>

### ìƒ˜í”Œë§  

ìœ„ ë°ì´í„°ëŠ” í‘œë³¸ì´ì§€ë§Œ ëª¨ì§‘ë‹¨ì´ë¼ ê°€ì •í•˜ê³  ìƒ˜í”Œë§ì„ ì§„í–‰í•´ë³¸ë‹¤.

```py
sample_data = data.sample(n=500, replace=True)  #ë³µì›ì¶”ì¶œ
print(sample_data.head(5), len(sample_data))

ctab2 = pd.crosstab(index=sample_data['age'], columns=sample_data['service'])  
print(ctab2)

chi2, p, df, exp = stats.chi2_contingency(ctab2)

msg = 'chi2: {}, p-value: {}, ddof: {},'
print(msg.format(chi2, p, df))
```

ìƒ˜í”Œë§ì„ í†µí•´ì„œë„ ê·€ë¬´ê°€ì„¤ì„ ê¸°ê°í•˜ëŠ” ê²°ê³¼ê°€ ë‚˜ì˜¤ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.

<br>

references:  
https://namyoungkim.github.io/scipy/probability/2017/09/04/scipy/  
https://bioinformaticsandme.tistory.com/139  
https://data-gardner.tistory.com/23
"""

<br><br>
